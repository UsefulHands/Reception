<div class="container-fluid py-4 bg-secondary-subtle min-vh-100">
  <div class="container">
    <div class="row g-4">
      <div class="col-md-4">
        <div class="card border border-2 border-dark-subtle shadow">
          <div class="card-header bg-primary text-white py-3 border-bottom border-2">
            <h6 class="mb-0 fw-bold">{{ isEditMode ? 'EDIT GUEST' : 'ADD NEW GUEST' }}</h6>
          </div>
          <div class="card-body p-4 bg-white">
            <form (ngSubmit)="saveGuest()">
              <div class="mb-3">
                <label class="form-label small fw-bold text-dark">First Name</label>
                <input type="text" class="form-control border-secondary shadow-sm" [(ngModel)]="selectedGuest.firstName" name="firstName" required>
              </div>
              <div class="mb-3">
                <label class="form-label small fw-bold text-dark">Last Name</label>
                <input type="text" class="form-control border-secondary shadow-sm" [(ngModel)]="selectedGuest.lastName" name="lastName" required>
              </div>
              <div class="mb-3">
                <label class="form-label small fw-bold text-dark">Identity Number</label>
                <input type="text" class="form-control border-secondary shadow-sm" [(ngModel)]="selectedGuest.identityNumber" name="identityNumber">
              </div>
              <div class="mb-3">
                <label class="form-label small fw-bold text-dark">Phone Number</label>
                <input type="text" class="form-control border-secondary shadow-sm" [(ngModel)]="selectedGuest.phoneNumber" name="phoneNumber">
              </div>

              <hr class="my-4 text-secondary">

              @if (!isEditMode) {
                <h6 class="text-primary fw-bold mb-3 small">ACCOUNT CREDENTIALS</h6>
                <div class="mb-3">
                  <label class="form-label small fw-bold text-dark">Username</label>
                  <input type="text" class="form-control border-secondary shadow-sm" [(ngModel)]="selectedGuest.username" name="username" required>
                  <div class="form-text small">This will be the login username.</div>
                </div>
                <div class="mb-3">
                  <label class="form-label small fw-bold text-dark">Password</label>
                  <input type="password" class="form-control border-secondary shadow-sm" [(ngModel)]="selectedGuest.password" name="password" required>
                </div>
              } @else {
                <div class="alert alert-light border small text-muted mb-3">
                  <i class="bi bi-info-circle me-1"></i>
                  Account credentials cannot be modified here.
                </div>
              }

              <div class="d-grid gap-2 pt-2">
                <button type="submit" class="btn btn-primary fw-bold shadow">
                  {{ isEditMode ? 'Update Guest' : 'Save Guest' }}
                </button>
                <button type="button" class="btn btn-outline-dark btn-sm" (click)="resetForm()" *ngIf="isEditMode">
                  Cancel Edit
                </button>
              </div>
            </form> </div>
        </div>
      </div>

      <div class="col-md-8">
        <div class="card border border-2 border-dark-subtle shadow">
          <div class="card-header bg-white py-3 d-flex justify-content-between align-items-center border-bottom border-2">
            <h6 class="mb-0 fw-bold text-primary">GUEST MANAGEMENT LIST</h6>
            <button class="btn btn-sm btn-dark fw-bold shadow-sm" (click)="loadGuests()">Refresh</button>
          </div>
          <div class="card-body p-0">
            <div class="table-responsive">
              <table class="table table-bordered table-hover align-middle mb-0">
                <thead class="table-dark small">
                <tr>
                  <th class="ps-3">GUEST NAME</th>
                  <th>ID NUMBER</th>
                  <th>PHONE</th>
                  <th class="text-center pe-3">ACTIONS</th>
                </tr>
                </thead>
                <tbody class="bg-white">
                  @for (guest of guests; track guest.id) {
                    <tr>
                      <td class="ps-3 fw-bold text-dark">{{ guest.firstName }} {{ guest.lastName }}</td>
                      <td>{{ guest.identityNumber }}</td>
                      <td>{{ guest.phoneNumber }}</td>
                      <td class="text-center pe-3">
                        <button class="btn btn-sm btn-info text-white me-2 shadow-sm" (click)="editGuest(guest)">Edit</button>
                        <button class="btn btn-sm btn-danger shadow-sm" (click)="guest.id && deleteGuest(guest.id)">Delete</button>
                      </td>
                    </tr>
                  } @empty {
                    <tr>
                      <td colspan="4" class="text-center py-5 fw-bold text-danger">No guests found in the system.</td>
                    </tr>
                  }
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
